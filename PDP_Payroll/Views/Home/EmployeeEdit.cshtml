@model PDP_Payroll.Models.EmployeeModel
@{
    ViewBag.Title = "EmployeeEdit";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<script type="text/javascript">
    @if (TempData["Alert"] != null)
    {
        <text>alert('@TempData["Alert"]');</text>
        TempData["Alert"] = null;
    }
    function ValidateMartialStatus() {
        $('span.error-employee_MartialStatus').remove();
        $('span.valid-employee_MartialStatus').remove();
        if ($('#employee_MartialStatus').val()=="Select")
        {
            $('#employee_MartialStatus').after('<span class="error error-employee_MartialStatus" style="color:red;"></br>Select Martial Status</span>');
        } else {
            $('#employee_MartialStatus').after('<span class="valid valid-employee_MartialStatus" style="color:red;"></br></span>');
        }
    }
    function ValidatePayrollType() {
        $('span.error-@Html.DisplayNameFor(m=>m.Payroll_Type)').remove();
        $('span.valid-@Html.DisplayNameFor(m => m.Payroll_Type)').remove();
        if ($('#@Html.DisplayNameFor(m => m.Payroll_Type)').val()=="Select")
        {
            $('#@Html.DisplayNameFor(m => m.employee_Wages)').attr('placeholder','Wage Rate(hourly)');
            $('#@Html.DisplayNameFor(m => m.Payroll_Type)').after('<span class="error error-@Html.DisplayNameFor(m => m.Payroll_Type)" style="color:red;"></br>Select PayRoll Type</span>');
        }
        else if ($('#@Html.DisplayNameFor(m => m.Payroll_Type)').val()=="BiWeekly"||$('#@Html.DisplayNameFor(m => m.Payroll_Type)').val()=="Weekly"||$('#@Html.DisplayNameFor(m => m.Payroll_Type)').val()=="Monthly")
        {
            $('#@Html.DisplayNameFor(m => m.employee_Wages)').attr('placeholder','Wage Rate(hourly)');
            $('#@Html.DisplayNameFor(m => m.Payroll_Type)').after('<span class="valid valid-@Html.DisplayNameFor(m => m.Payroll_Type)" style="color:red;"></br></span>');
        }
        else if ($('#@Html.DisplayNameFor(m => m.Payroll_Type)').val()=="Salary"){

            $('#@Html.DisplayNameFor(m => m.employee_Wages)').attr('placeholder','Salary(fixed)');
            $('#@Html.DisplayNameFor(m => m.Payroll_Type)').after('<span class="valid valid-@Html.DisplayNameFor(m => m.Payroll_Type)" style="color:red;"></br></span>');

        }
        else {
            $('#@Html.DisplayNameFor(m => m.Payroll_Type)').after('<span class="valid valid-@Html.DisplayNameFor(m => m.Payroll_Type)" style="color:red;"></br></span>');
        }
    }
    $(document).ready(function()
    {
        $('#employee_name').keyup(function () {
            $('span.error-employee_name').remove();
            $('span.valid-employee_name').remove();
            var inputVal = $(this).val();
            if (inputVal.length > 0) {
                var regex = /^[A-Za-z ]{3,25}$/;
                if (!regex.test(inputVal)) {
                    $(this).after('<span class="error error-employee_name" style="color:red;"></br>Invalid Employee Name</span>');
                }
                else {
                    $(this).after('<span class="valid valid-employee_name hidden" style="color:green;"></br></span>');
                }
            }
            else {
                $(this).after('<span class="error error-employee_name" style="color:red;"></br>*Required!</span>');
            }
        });
         $('#employee_name').focusout(function () {
             $('span.error-employee_name').remove();
             $('span.valid-employee_name').remove();
            var inputVal = $(this).val();
            if (inputVal.length > 0) {
                var regex = /^[A-Za-z ]{3,25}$/;
                if (!regex.test(inputVal)) {
                    $(this).after('<span class="error error-employee_name" style="color:red;"></br>Invalid Employee Name</span>');
                }
                else {
                    $(this).after('<span class="valid valid-employee_name hidden" style="color:green;"></br></span>');
                }
            }
            else {
                $(this).after('<span class="error error-employee_name" style="color:red;"></br>*Required!</span>');
            }
         });
         $('#employee_Fathername').keyup(function () {
             $('span.error-employee_Fathername').remove();
             $('span.valid-employee_Fathername').remove();
             var inputVal = $(this).val();
             if (inputVal.length > 0) {
                 var regex = /^[A-Za-z ]{3,25}$/;
                 if (!regex.test(inputVal)) {
                     $(this).after('<span class="error error-employee_Fathername" style="color:red;"></br>Invalid Father Name</span>');
                 }
                 else {
                     $(this).after('<span class="valid valid-employee_Fathername hidden" style="color:green;"></br></span>');
                 }
             }
             else {
                 $(this).after('<span class="error error-employee_Fathername" style="color:red;"></br>*Required!</span>');
             }
         });
         $('#employee_Fathername').focusout(function () {
             $('span.error-employee_Fathername').remove();
             $('span.valid-employee_Fathername').remove();
             var inputVal = $(this).val();
             if (inputVal.length > 0) {
                 var regex = /^[A-Za-z ]{3,25}$/;
                 if (!regex.test(inputVal)) {
                     $(this).after('<span class="error error-employee_Fathername" style="color:red;"></br>Invalid Father Name</span>');
                 }
                 else {
                     $(this).after('<span class="valid valid-employee_Fathername hidden" style="color:green;"></br></span>');
                 }
             }
             else {
                 $(this).after('<span class="error error-employee_Fathername" style="color:red;"></br>*Required!</span>');
             }
         });
         $('#employee_NoOfDependency').keyup(function () {
             $('span.error-employee_NoOfDependency').remove();
             $('span.valid-employee_NoOfDependency').remove();
             var inputVal = $(this).val();
             if (inputVal.length > 0) {
                 $(this).after('<span class="valid valid-employee_NoOfDependency hidden" style="color:green;"></br></span>');
             }
             else {
                 $(this).after('<span class="error error-employee_NoOfDependency" style="color:red;"></br>*Required!</span>');
             }
         });
         $('#employee_NoOfDependency').focusout(function () {
             $('span.error-employee_NoOfDependency').remove();
             $('span.valid-employee_NoOfDependency').remove();
             var inputVal = $(this).val();
             if (inputVal.length > 0) {
                 $(this).after('<span class="valid valid-employee_NoOfDependency hidden" style="color:green;"></br></span>');
             }
             else {
                 $(this).after('<span class="error error-employee_NoOfDependency" style="color:red;"></br>*Required!</span>');
             }
         });
         $('#employee_NIC').keyup(function () {
             $('span.error-employee_NIC').remove();
             $('span.valid-employee_NIC').remove();
             var inputVal = $(this).val();
             if (inputVal.length > 0) {
                 var regex = /^\(?([0-9]{3})\)?[-]?([0-9]{2})[-]?([0-9]{4})$/;
                 if (!regex.test(inputVal)) {
                     $(this).after('<span class="error error-employee_NIC" style="color:red;"></br>Invalid NIC</span>');
                 }
                 else {
                     $(this).after('<span class="valid valid-employee_NIC hidden" style="color:green;"></br></span>');
                 }
             }
             else {
                 $(this).after('<span class="error error-employee_NIC" style="color:red;"></br>*Required!</span>');
             }
         });
         $('#employee_NIC').focusout(function () {
             $('span.error-employee_NIC').remove();
             $('span.valid-employee_NIC').remove();
             var inputVal = $(this).val();
             if (inputVal.length > 0) {
                 var regex = /^\(?([0-9]{3})\)?[-]?([0-9]{2})[-]?([0-9]{4})$/;
                 if (!regex.test(inputVal)) {
                     $(this).after('<span class="error error-employee_NIC" style="color:red;"></br>Invalid NIC</span>');
                 }
                 else {
                     $(this).after('<span class="valid valid-employee_NIC hidden" style="color:green;"></br></span>');
                 }
             }
             else {
                 $(this).after('<span class="error error-employee_NIC" style="color:red;"></br>*Required!</span>');
             }
         });
         $('#employee_address').keyup(function () {
             $('span.error-employee_address').remove();
             $('span.valid-employee_address').remove();
             var inputVal = $(this).val();
             if (inputVal.length > 15) {
                 var regex = /^[a-zA-Z0-9 ,.\-]{15,75}$/;
                 if (!regex.test(inputVal)) {
                     $(this).after('<span class="error error-employee_address" style="color:red;"></br>Only Address special characters</span>');
                 }
                 else {
                     $(this).after('<span class="valid valid-employee_address hidden" style="color:green;"></br></span>');
                 }
             }
             else {
                 $(this).after('<span class="error error-employee_address" style="color:red;"></br>Address Length should be minimum 15</span>');
             }
         });
         $('#employee_address').focusout(function () {
             $('span.error-employee_address').remove();
             $('span.valid-employee_address').remove();
             var inputVal = $(this).val();
             if (inputVal.length > 15) {
                 var regex = /^[a-zA-Z0-9 ,.\-]{15,75}$/;
                 if (!regex.test(inputVal)) {
                     $(this).after('<span class="error error-employee_address" style="color:red;"></br>Only Address special characters</span>');
                 }
                 else {
                     $(this).after('<span class="valid valid-employee_address hidden" style="color:green;"></br></span>');
                 }
             }
             else {
                 $(this).after('<span class="error error-employee_address" style="color:red;"></br>Address Length should be minimum 15</span>');
             }
         });
         $('#employee_email').keyup(function ()  {
             $('span.error-employee_email').remove();
             $('span.valid-employee_email').remove();
             var inputVal = $(this).val();
             if (inputVal.length > 0) {
                 var regex = /^([a-zA-Z0-9_\-\.]+)@('@')((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([a-zA-Z0-9\-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)$/;
                 if (!regex.test(inputVal)) {
                     $(this).after('<span class="error error-employee_email" style="color:red;"></br>Invalid Email</span>');
                 }
                 else{

                     $(this).after('<span class="valid valid-employee_email hidden" style="color:green;"></br></span>');
                 }
             }
             else {
                 $(this).after('<span class="error error-employee_email" style="color:red;"></br>*Required!</span>');
             }
         });
         $('#employee_email').focusout(function () {
             $('span.error-employee_email').remove();
             $('span.valid-employee_email').remove();
             var inputVal = $(this).val();
             if (inputVal.length > 0) {
                 var regex = /^([a-zA-Z0-9_\-\.]+)@('@')((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([a-zA-Z0-9\-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)$/;
                 if (!regex.test(inputVal)) {
                     $(this).after('<span class="error error-employee_email" style="color:red;"></br>Invalid Email</span>');
                 }
                 else{

                     $(this).after('<span class="valid valid-employee_email hidden" style="color:green;"></br></span>');
                 }
             }
             else {
                 $(this).after('<span class="error error-employee_email" style="color:red;"></br>*Required!</span>');
             }
         });
        $('#employee_phoneNo').keyup(function() {
            $('span.error-employee_phoneNo').remove();
            $('span.valid-employee_phoneNo').remove();
            var inputVal = $(this).val();
            if(inputVal.length>0)
            {
                var regex = /^([+])?([0-9]( |-)?)?(\(?[0-9]{3}\)?|[0-9]{3})( |-)?([0-9]{3}( |-)?[0-9]{4}|[a-zA-Z0-9]{7})$/;
                if(!regex.test(inputVal)) {
                    $(this).after('<span class="error error-employee_phoneNo" style="color:red;"></br>Invalid Phone no e.g : 1-(123)-123-1234 | 123 123 1234 </span>');
                }
                else{
                    $(this).after('<span class="valid valid-employee_phoneNo hidden" style="color:green;"></br></span>');
                }
            }
            else{
                $(this).after('<span class="error error-employee_phoneNo" style="color:red;"></br>*Required!</span>');
            }
        });
        $('#employee_phoneNo').focusout(function() {
            $('span.error-employee_phoneNo').remove();
            $('span.valid-employee_phoneNo').remove();
            var inputVal = $(this).val();
            if(inputVal.length>0)
            {
                var regex = /^([+])?([0-9]( |-)?)?(\(?[0-9]{3}\)?|[0-9]{3})( |-)?([0-9]{3}( |-)?[0-9]{4}|[a-zA-Z0-9]{7})$/;
                if(!regex.test(inputVal)) {
                    $(this).after('<span class="error error-employee_phoneNo" style="color:red;"></br>Invalid Phone no e.g : 1-(123)-123-1234 | 123 123 1234 </span>');
                }
                else{
                    $(this).after('<span class="valid valid-employee_phoneNo hidden" style="color:green;"></br></span>');
                }
            }
            else{
                $(this).after('<span class="error error-employee_phoneNo" style="color:red;"></br>*Required!</span>');
            }
        });
        $('#employee_Wages').keyup(function () {
            $('span.error-employee_Wages').remove();
            $('span.valid-employee_Wages').remove();
            var inputVal = $(this).val();
            if (inputVal.length > 0) {
                $(this).after('<span class="valid valid-employee_Wages hidden" style="color:green;"></br></span>');
            }
            else {
                $(this).after('<span class="error error-employee_Wages" style="color:red;"></br>*Required!</span>');
            }
        });
        $('#employee_Wages').focusout(function () {
            $('span.error-employee_Wages').remove();
            $('span.valid-employee_Wages').remove();
            var inputVal = $(this).val();
            if (inputVal.length > 0) {
                $(this).after('<span class="valid valid-employee_Wages hidden" style="color:green;"></br></span>');
            }
            else {
                $(this).after('<span class="error error-employee_Wages" style="color:red;"></br>*Required!</span>');
            }
        });
        $('#submit').click(function () {
            $('span.error-btn').remove();
            if ( $('span.valid').length==10)
            {
                return true;
            }
            else
            {
                $(this).after('<span class="error-btn" style="color:red"></br>     *Fill All Fields</span>');
                return false;
            }
        });
    });
</script>
<br />
<div class="parallax light-wrapper parallax4">
    <div class="container inner ">
        <div class="thin">
            <div class="carousel-wrapper">

                @if (Model == null)
                {
                    <h3 class="main-title text-center">Add Employee</h3>
                }
                else
                {
                    <h3 class="main-title text-center">Edit Emplyee</h3>
                }

                <br />
                @using (Html.BeginForm())
                {
                    @Html.AntiForgeryToken()

                    <div class="form-container">

                        @Html.ValidationSummary(true, "", new { @class = "text-danger" })

                        <div class="row ">
                                <div class="col-md-12 hidden">
                                    @Html.EditorFor(model => model.employee_id, new { htmlAttributes = new { @class = "form-control", @placeholder = "Branch Id" } })

                                </div>
                                <h5>Personal Info</h5>
                            <div class="row ">
                                <div class="col-md-6">
                                    <div class="form-field">
                                        <label>
                                            @Html.EditorFor(model => model.employee_name, new { htmlAttributes = new { @class = "form-control", @placeholder = "Emplyee Name" } })
                                            <span class="error error-employee_name" style="color:red;"><br /></span>
                                            <i class="icon-user"></i>
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-field">
                                        <label>
                                            @Html.EditorFor(model => model.employee_Fathername, new { htmlAttributes = new { @class = "form-control", @placeholder = "Employee Father Name" } })
                                            <span class="error error-employee_Fathername" style="color:red;"><br /></span>
                                            <i class="icon-user-1"></i>
                                        </label>
                                    </div>
                                </div>
                                </div>

                            <div class="row ">
                                <div class="col-md-6">
                                    <div class="form-field">
                                        <label class="custom-select">
                                            <select name="employee_MartialStatus" id="employee_MartialStatus" onchange="ValidateMartialStatus();" onfocus="ValidateMartialStatus();">
                                                <option value="Select">Select Martial status</option>
                                                <option value="Single">single</option>
                                                <option value="Married">Married</option>
                                            </select>
                                            <i class="icon-users"></i>
                                        </label>
                                    </div>
                                </div>
                                <script type="text/javascript">
                                    @if (Model != null)
                                    {
                                    <text>
                                    $('#employee_MartialStatus').val('@Model.employee_MartialStatus');
                                    </text>
                                    }
                                </script>
                                <div class="col-md-6">
                                    <div class="form-field">
                                        <label>
                                            @Html.EditorFor(model => model.employee_NoOfDependency, new { htmlAttributes = new { @class = "form-control", @placeholder = "No of Dependency" } })
                                            <span class="error error-branch_phone" style="color:red;"><br /></span>
                                            <i class="budicon-wallet"></i>
                                        </label>
                                    </div>
                                </div>
                                </div>

                            <div class="row ">
                                <div class="col-md-6">
                                    <div class="form-field">
                                        <label>
                                            @Html.EditorFor(model => model.employee_NIC, new { htmlAttributes = new { @class = "form-control", @placeholder = "Employee NIC" } })
                                            <span class="error error-employee_NIC" style="color:red;"><br /></span>
                                            <i class="icon-credit-card"></i>
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-5">
                                    <div class="form-field">
                                        <label class="custom-select">
                                            @Html.DropDownList("state_id", null, htmlAttributes: new { @class = "", @style = "margin-left:20%;" })                                            
                                            <i class="icon-compass">State</i>
                                        </label>
                                    </div>
                                </div>
                                
                                @if (Model != null)
                                {
                                    <script>
                                        $('#state_id').val('@Model.state_id');
                                    </script>
                                }
                            </div>

                            <div class="row ">
                                <div class="col-md-12">
                                    <textarea placeholder="Employee Address" class="" id="employee_address" name="employee_address">@if (Model != null)
                                    {@Model.employee_Address;
                                    }</textarea>
                                    <span class="error error-branch_address" style="color:red;"><br /></span>
                                </div>
                                </div>
                                <h5>Contact Info</h5>

                            <div class="row ">
                                <div class="col-md-6">
                                    <div class="form-field">
                                        <label>
                                            @Html.EditorFor(model => model.employee_email, new { htmlAttributes = new { @class = "form-control", @placeholder = "Emplyee Email" } })
                                            <span class="error error-branch_email" style="color:red;"><br /></span>
                                            <i class="icon-mail"></i>
                                        </label>
                                    </div>
                                </div>


                                <div class="col-md-6">
                                    <div class="form-field">
                                        <label>
                                            @Html.EditorFor(model => model.employee_phoneNo, new { htmlAttributes = new { @class = "form-control", @placeholder = "Employee Phone No" } })
                                            <span class="error error-branch_phone" style="color:red;"><br /></span>
                                            <i class="icon-phone"></i>
                                        </label>
                                    </div>
                                </div>

                            </div>
                                <h5>Company Info</h5>

                            <div class="row ">
                                <div class="col-md-6">
                                    <div class="form-field">
                                        <label>
                                            <input name="@Html.DisplayNameFor(m => m.Date_of_Join)" id="@Html.DisplayNameFor(m => m.Date_of_Join)" type="date" style="width:74.5%;float:right"
                                                  min="@(DateTime.Now.Year - 2)-01-01"  />
                                            <span class="error error-branch_phone" style="color:red;"><br /></span>
                                            <i class="icon-clock">Date of Join</i>
                                        </label>
                                    </div>
                                </div>
                                <script>
                                    document.getElementById("Date_of_Join").value = "@if (Model != null)
                                    {
                                        @Model.Date_of_Join.ToString("yyyy-MM-dd");
                                    }
                                    else
                                    {
                                         @DateTime.Now.ToString("yyyy-MM-dd");
                                         @*@("2014-02-09");*@
                                    }";
                                </script>
                                <div class="col-md-5">
                                    <div class="form-field">
                                        <label class="custom-select">
                                            @Html.DropDownList("branch_id", null, htmlAttributes: new { @class = "", @style = "margin-left:23%;" })
                                            <i class="icon-compass">Branch</i>
                                        </label>
                                    </div>
                                </div>
                                @if (Model != null)
                                {
                                    <script>
                                        $('#branch_id').val('@Model.branch_id');
                                    </script>
                                }

                            </div>

                            <div class="row ">
                                <div class="col-md-6">
                                    <div class="form-field" >
                                        <label class="custom-select">
                                            <select name="@Html.DisplayNameFor(m=>m.Payroll_Type)" id="@Html.DisplayNameFor(m=>m.Payroll_Type)" onchange="ValidatePayrollType();" onfocus="ValidatePayrollType  ();">
                                                <option value="Select">Select PayRoll Type</option>
                                                <option value="BiWeekly">BiWeekly</option>
                                                <option value="Weekly">Weekly</option>
                                                <option value="Monthly">Monthly</option>
                                                <option value="Salary">Salary</option>
                                            </select>
                                            <i class="budicon-setting"></i>
                                        </label>
                                    </div>
                                </div>
                                <script type="text/javascript">
                                    @if (Model != null)
                                    {
                                    <text>
                                    $('#Payroll_Type').val('@Model.Payroll_Type');
                                    </text>
                                    }
                                </script>
                                <div class="col-md-6">
                                    <div class="form-field">
                                        <span id="Payroll_Type-div"></span>
                                        <label id="id_wage">
                                            @Html.EditorFor(model => model.employee_Wages, new { htmlAttributes = new { @class = "form-control", @placeholder = "Wage Rate (hourly)" } })
                                            <span class="error error-branch_phone" style="color:red;"><br /></span>
                                            <i class="icon-money"></i>
                                        </label>
                                    </div>
                                </div>
                            </div>
                            </div>
                                                            <br />

                                    <div class="col-md-12">
                                        <input type="submit" value="Submit" id="submit" class="btn btn-default" style="width:100%" />
                                    </div>
                                    <br />

                                </div>




                        @Html.ActionLink("View Employee List", "EmployeeList", null, new { @class = "text-center" })
                    
                }

            </div>
        </div>
    </div>
</div>
<script type="text/javascript">
    $(document).ready(function()
    {
        if($('#employee_id').val()>0){
            $('span.error').remove();
                           
            $('#submit').after('<span class="valid valid-employee_name hidden" style="color:green;"></br></span>');
            $('#submit').after('<span class="valid valid-employee_Fathername hidden" style="color:green;"></br></span>');
            $('#submit').after('<span class="valid valid-employee_email hidden" style="color:green;"></br></span>');
            $('#submit').after('<span class="valid valid-employee_phoneNo hidden" style="color:green;"></br></span>');
            $('#submit').after('<span class="valid valid-employee_Address hidden" style="color:green;"></br></span>');
            $('#submit').after('<span class="valid valid-employee_NIC hidden" style="color:green;"></br></span>');
            $('#submit').after('<span class="valid valid-employee_MartialStatus hidden" style="color:green;"></br></span>');
            $('#submit').after('<span class="valid valid-employee_NoOfDependency hidden" style="color:green;"></br></span>');
            $('#submit').after('<span class="valid valid-employee_Wages hidden" style="color:green;"></br></span>');            
            $('#submit').after('<span class="valid valid-Payroll_Type hidden" style="color:green;"></br></span>');
        }

    });
</script>



